i
j
separator
t
rnd
step
n
a
i
j
k
b
i
j
separator
i
j
t
n
a1
a2
time
separator
i
j
t
mid
b
i
j
k
size
mid
b
i
j
k
mid
first
Cut
second
Cut
t
next
lo
hi
mid
n
i
child
i
j
n
p
i
i
j
b
i
i
j
i
j
max
cnt
i
n
b
i
d
w
t
p
cnt
i
i
i
rnd
step
n
a
s
b
step
n
a
s
b
k
i
j
separator
t
a5
i
cnt
j
iteration
k
t
separator
Index
k
rnd
len
step
n
a
b
k
sa
sb
i
prime
i
j
primes
cnt
i
lp
primes
cnt
i
j
i
divisors
i
j
lp
primes
cnt
i
j
divisors
i
j
res
i
res
i
j
n
primes1
primes2
phi
PHI
i
factors
d
divisors
d
rnd
x
y
d
x
y
r
n
res
d
exp
power
divisor
res
i
j
exp
divisors
i
j
gcd
g
a
b
c
d
t
x
y
x1
y1
q

x1

y1

b
r
res
i
x
i
j
res
m
i
res
i
m
rnd
steps
a
b
xa
xb
gcd1
gcd2
gcd
euclid1
euclid2
inv1
inv2
inv
a
b
res
MOD
n
z
res
i
nz
j
div
res
m
i
x
n
y
i
mod
dd
i
v
g
a
b
n
logn
ta
tb
i
i
j
k
tc
i
j
k
i
j
k
result
i
n
result
i
j
a
b
res
p
n
shift
i
j
temp
root
inv
len
wlen
i
j
w
u
v
nrev
i
need
n
A
B
i
i
mod
root
i
carry
i
rnd
step
n1
s1
a
i
x
n2
s2
b
i
x
res
s
mul
i
mod
root
i
n
step
i
j
u
v
i
a
b
n
shift
i
j
temp
len
half
Len
cs
sn
i
angle
i
j
u
A
u
B
v
A
v
B
i
need
n
p
Real
p
Imag
i
i
ab
Real
ab
Imag
i
j
result
i
carry
need
n
a
Real
a
Imag
i
x
b
Real
b
Imag
i
x
fa
Real
fa
Imag
fb
Real
fb
Imag
i
j
a1r
a1i
a2r
a2i
b1r
b1i
b2r
b2i
res
i
aa
bb
cc
rnd
step
n1
s1
a
i
x
n2
s2
b
i
x
res1
res2
s
mul
need
n
a
Real
a
Imag
b
Real
b
Imag
i
i
i
real
result
i
carry
n
res
i
j
k
a1
a2
b1
b2
a1b1
a2b2
i
i
r
i
i
i
i
eps
m
am
mb
ab
n
dp
i
mask
i
j
res
i
cur
order
last
i
bj
j
dist
n
s
dp
i
i
j
min
x
y
i
middle
i
res
a
b
c
m
res
n
p
m
len
a
b
c
v
n
cache
p
res
k
v
rnd
step
n
s
res1
res2
n
tail
prev
len
i
pos
res
i
lo
hi
mid
lis
prev
r
c
cur
mask
prev
r
c
cur
mask
nmask
r
c
res1
res2
dp
r
c
prev
mask
n
dp
mask
i
j
res
i
cur
order
last
i
bj
j
dist
n
len
pred
bi
i
j
cnt
res
i
a
lis
v
u
res
nv
y
rnd
step
n
g
weights
i
i
j
i
res1
res2
res
n
set
ok
i
j
cur
i
n
id
deg
i
res
from
to
best
i
t
i
used
i
i
tmp
rnd
step
n
g
i
j
res1
res2
n
allowed
Colors
colors
i
c
col
cur
i
i
j
d
x
y
AB
AC
z1
z2
z3
z4
z1
z2
z3
z4
a1
b1
c1
a2
b2
c2
det
x
y
rnd
step
r
x1
y1
x2
y2
x3
y3
x4
y4
cross
Intersect
cross
Or
Touch
Intersect
cross
Or
Touch
Intersect2
n
cnt
i
j
det
x
y
sorted
X
sorted
Y
result
mid
midx
i
sorted
Y1
sorted
Y2
d1
d2
t
size
i
i
j
a
b
dist2
dx
dy
rnd
step
n
points
i
p
res1
res2
res
i
j
n
points
i
union
balance
i
cmp
polygons
xs
i1
j1
i2
j2
intersection
xsa
res
k
x
sweep0
sweep1
events
p
polygon
area
i
j
j
i
intersection
y
x0
x1
a
mask
j
a1
b1
c1
a2
b2
c2
det
x
y
z1
z2
z3
z4
n
res
i
j
d1
d2
cross
EPS
a1
b1
c1
a2
b2
c2
det
x
y
a
b
c
r
aabb
d
x0
y0
k
A
B
C
d
y1
x1
y2
x2
dx
dy
A
B
C
res
r
R
d
area
lines
i
j
r
z
d
circle
i
j
k
x
y
r
Bx
By
Cx
Cy
d
z1
z2
cx
cy
x
y
r
rnd
step
range
x
y
r
x1
y1
x2
y2
p1
p2
mid
n
events
y
i
rect
x1
x2
y1
y2
t
area
last
X
i
in
x
dx
dy
y1
y2
from
to
rnd
step
n
rectangles
i
range
x
y
width
height
res1
area
x
y
res2
coords
pi
type
i
j
result
mid
midx
d1
d2
t
size
i
i
j
a
b
dist2
dx
dy
rnd
step
n
points
i
p
res1
res2
res
i
j
dx
dy
px
py
squared
Length
dot
Product
q
rnd
step
r
x
y
x1
y1
x2
y2
res1
res2
rnd
x
y
p
i
improved
i
j
p1
tx
ty
i
ok
i
x1
y1
x2
y2
i2
i1
j2
j1
n
t
res
i
j
dx
dy
z1
z2
z3
z4
xy
n
i
j
i
cs
sn
s
z
u
v
a
b
a
a
n
area
i
j
up1
up2
cmp
rnd
range
step
ax
ay
bx
by
cx
cy
orientation1
orientation2
res1
res2
points
n
hull
cnt
i
j
cross
dot
points
convex
Hull
cross
n
events
i
cnt
set
cur
floor
ceiling
lower
higher
v
v
x1
y1
x2
y2
x3
y3
x4
y4
z1
z2
z3
z4
rnd
step
n
s
i
r
x1
y1
x2
y2
intersection
has
Intersection
i
j
cs
sn
s
u
v
a
b
area
i
j
cur
points
area
i
p1
p2
a
aabb
d
x0
y0
k
c
operand
v
v
v
v
engine
exp
parser
val
ident
node
node
node
kind
node
node
node
node
node
program
addr
addr1
addr2
addr1
addr2
addr
var
stack
pc
op
arg
i
lexer
parser
ast
compiler
program
vm
op
r
l
st
ops
i
c
operand
engine
exp
left
left
v
e
f
z
x
s
s
calc
res
n
color
next
u
cycle
Start
cycle
i
cycle
Start
graph
cycle
n
used
colors
q
i
i
bestu
c
n
g
i
j
n
inqueue
q
qt
qh
u
i
e
v
ndist
n
dist
curflow
prevedge
prevnode
flow
flow
Cost
df
v
e
mcf
res
flow
flow
Cost
flow
q
qt
pred
qh
cur
df
u
u
flow
flow
j
capacity
rnd
test
n
edges
path
i
more
Edges
i
u
v
f1
f2
f3
u
v
capacity
cost
maxf
s
t
res1
res2
res3
res
i
j
q
size
Q
i
u
e
df
flow
ptr
df
cut
i
flow
n
inqueue
q
qt
qh
u
i
e
v
ndist
h
u
i
e
v
nprio
n
i
u
j
k
e
v
nprio
n
pot
dist
finished
curflow
prevedge
prevnode
flow
flow
Cost
i
df
v
e
mcf
res
flow
flow
Cost
n
d
p
flow
flow
Cost
i
j
k
v
mcf
res
flow
flow
Cost
flow
df
v
df
capacity
t
cur
v
nprio
res
cost
n
edges
i
j
dist
pred
n
visited
i
u
j
v
nprio
cost
n
graph
i
j
dist
pred
n
step
updated
u
n
pred
dist
last
step
u
i
p
cnt
u
cycle
i
graph
cycle
n
pred
i
j
k
i
j
i
n
path
pos
dist
pred
path
q
cur
curu
v
nprio
cost
n
graph
i
j
dist
pred
h
u
v
nprio
cost
n
edges
i
j
dist
pred
i
i
i
match
has
augmenting
path
u
u
t
u
bx
by
h
lca
t
mv
x
lx
px
bx
eid
y
time
next
time
next
time
lim
updated
h
e
x
y
u
maximum
u
t
x
y
px
lx
eid
y
by
ly
stack
beg
bv
bw
bv
v
z
bz
v
u
i
u
ret
u
bu
v
i
n
edges
mm
ans
i
n
m
u
v
p
way
i
minv
used
j0
i0
delta
j1
j
d
j
j1
matching
i
a
res
n1
dist
matching
used
res
vis
f
u
n1
Q
size
Q
u
i
u1
u2
u2
graph
up
up
k
nk
k
i
i
i
w
n
pv
nv
pn
tmp
lc
a
b
na
s
t
i
i
u
ret
ret
u
max
c
eid
t
x
y
bv
mv1
bmv1
d
mv
bmv
v
bv
b
r
augmented
d
dt
gy
m
m
d
t
t
bb
lb
largest
size
beta
b
beta
b
bx
by
h
lca
tmp
bid
tree
size
d
bv
mv
bmv
v
f
t
tmp
b
pb
bv
bw
nl
b
by
visited
z
bz
v
beta
bb
w
bb
to
h
d
beta
b
mv
old
link
old
base
root
d
b
b
nb
x
bx
eid
e
y
by
l
t
t
time1
time2
time3
e
x
y
time4
time
next
x
x
y
x
eid
y
b
i
u
u
b
i
i
i
u
max
c
eid
u
eid
e
v
n
edges
mm
res
r
n
j
k
t
inv
i
u
v
n
a
rnd
i
j
res
n
match
p
i
v
pv
ppv
n
bases
used
q
qt
qh
u
base
blossom
i
used
graph
n1
matching
matches
u
u2
g
i
u
pr
e
xr
pr
i
xnv
tmp
tmp
b
x
y
x
y
x
x
i
xs
x
x
xr
pr
i
xs
xns
i
xs
u
v
nu
lca
x
u
v
d
b
x
u
b
x
b
n
matches
tot
weight
u
w
max
u
v
u
u
u
v
n
mm
res
n1
n2
matching
matches
u
v
u2
n
cur
Edge
stack
top
u
v
g
n
u
children
cut
Point
component
e
component
x
comp
i
g
u
edges
n
graph
bc
n
used
order
i
reverse
Graph
i
components
component
comp
i
g
edges
u
g
components
n
used
order
i
g
order
used
Edges
n
cur
Edge
res
v
cur
Edge
res
stack
used
Edges
v
n
cur
Edge
res
cur
Edge
res
stack
n
g
mid
nodes
i
mid
p1
p2
tree
lca
n
hw
hb
hz
ex
ey
tree
lca
i
n
i
tree
t
n
leaves
degree
i
removed
Leaves
nleaves
n
cnt
good
Center
res
size
furthest
Vertex
res
n
tree
n
m
k
i
j
dp
i
j
i
j
k
j
k
n
used
prio
q
res
cur
u
v
cost
n
edges
i
j
pred
n
prev
dist
visited
res
i
u
j
j
rnd
step
n
a
lis
s
higher
last
len
pos
lo
hi
mid
n
found
mask
len
i
prev
ok
i
j
sum
Angles
i
j
x1
y1
x2
y2
rnd
x2
y2
cnt
i
j
step
n
range
xy
x
y
qx
qy
res
i
j
res1
res2
res3
x
y
p
i
improved
i
j
p1
tx
ty
i
ok
i
x1
y1
x2
y2
i2
i1
j2
j1
n
t
res
i
j
dx
dy
z1
z2
z3
z4
z1
z2
z3
z4
n
h
cnt
i
i
t
rnd
step
n
points
i
range
convex
Hull
convex
Hull2
i
i
hull
list
exterior
n
cnt
i
j
det
step
n
range
polygon1
polygon2
res1
res2
polygon
i
a
pt
x
y
area
p
cur
i
j
polygon
x
y
p
i
improved
i
j
p1
tx
ty
i
ok
i
x1
y1
x2
y2
i2
i1
j2
j1
n
t
res
i
j
dx
dy
z1
z2
z3
z4
step
n
range
xy
x
y
r
res1
res2
count
hits
minx
maxx
miny
maxy
i
px
py
n
cnt
i
j
det
x
y
p
i
improved
i
j
p1
tx
ty
i
ok
i
x1
y1
x2
y2
i2
i1
j2
j1
n
t
res
i
j
dx
dy
z1
z2
z3
z4
rnd
step
n
g
graph
i
j
res1
res2
n
dp
mask
i
j
rnd
step
n1
n2
g
i
j
res1
res2
n1
mask
i
res
m
cur
i
rnd
step
n1
n2
g
i
j
res1
res2
n1
n2
mask
i
j
res
m
cur
i
rnd
step
max
n
m
a
i
j
res1
res2
n
m
dp
res
mask
i
j
n
m
res
p
i
cur
i
used
m
i
j
k
rnd
step
n
tree
depth
root
q
i
a
b
path
res1
res2
t
p
i
j
i
parent
rnd
step
n
tree
depth
root
q
i
a
b
path
res1
res2
t
p
i
j
i
parent
rnd
step
n1
n2
s1
s2
s
tree
res2
lcs
res
i
j
rnd
step
s
pattern
pos1
pos2
z
i
n
s
i
rnd
step
len1
len2
a
b
occurrences1
occurrences2
p
res1
res2
lcs
res
i
j
rnd
step
n
tree
hl
x
i
a
b
path
delta
res1
res2
step
n
tree
hl
x
u
i
a
b
path
delta
j
key
res1
res2
j
key
t
p
i
j
i
parent
n
b
i
i
sets
i
a
res
i
prefix
sequence
i
prefix
cur
total
i
p
j
size
i
res
i
i
j
size
last
i
balance
size
balance
p
i
j
i
j
size
sum
last
permutations
combinations
arrangements
correct
Bracket
Sequences
partitions
s
n
digits
res
i
prefix
num
2
5
all
2
5
n
s
i
p
x
j
cnt
res
sum
j
i
p
i
j
p
i
j
p
i
j
k
p
p1
list
c
i
j
res
i
res
i
res
i
used
m
i
j
k
a
free
i
i
cnt
pos
m
res
used
i
cnt
j
res
i
i
a
cnt
n
n
i
balance
open
close
s
n
tree
degree
ptr
leaf
v
n
parent
degree
ptr
i
res
i
leaf
next
a
tree
b
a
b
t
fact
i
p
free
i
i
pos
n
fact
i
res
i
a
j
n
i
s
r
ones
n
vis
res
i
j
cur
p
cnt
a
i
t
p
i
j
i
parent
g
edge
Set
i
j
i
edges
e
u
v
i
g
edge
Set
i
i
u
v
edge
i
res
i
i
j
t
tree
rnd
step
V
g
n
a
edges
i
i
j
rnd
i
j
t
rnd
res
i
j
rnd
res
i
i
j
t
res
rnd
set
res
x
k
i
c
cnt
i
j
am
k
res
prev
i
j
res
i
k
i
p
n
a
b
row
best
i
tt
t
i
i
z
j
a
b
x
i
y
j
n
m
res
i
j
n
m
k
res
i
j
p
n
res
i
a
b
c
x
y
EPS
n
a
res
i
p
j
t
j
j
k
d
prefix
Map
i
i
transitions
i
j
s
automaton
transitions
s
state
i
n
sa
classes
len
c
i
cnt
s
i
s1
n
sa
classes
len
c
i
cnt
s
i
s1
n
rank
i
lcp
i
h
j
s1
sa1
rnd
step
n
s
sa
ra
lcp
i
a
b
n
st
last
size
i
c
cur
p
q
clone
i
occurrences
lcs
automaton
node
next
occurrences
q
cur
Node
st
len
best
Len
best
Pos
i
cur
c
v
q
s
t
v
u
c
aho
Corasick
t
e
s
state
i
m
n
lcs
i
j
cnt
res
i
j
m
n
len
i
j
i
j
x
y
lcs
a
b
n
i
h1
h2
rnd
step
n1
s1
n2
s2
h1
h2
k
i1
j1
i2
j2
s
i
cnt
i
i
i
n0
n1
n2
n02
R
i
j
SA12
name
i
i
i
R0
i
j
SA0
p
t
k
i
j
n
S
sa
n
rank
i
lcp
i
h
j
rnd1
n2
ss
time
sa2
s1
sa1
rnd
step
n
s
sa
lcp
i
a
b
p
k
i
m
p
i
k
n
p
max
Border
min
Period
rnd
step
s
pattern
pos1
pos2
n
s
i
s
n
res
i
j
k
res
a
n
i
j
k
s
decompose
n
sa
rank
len
rank2
i
i
rnd
step
n
s
sa
i
n
a
i
root
node
i
tail
last
ch
after
Tail
split
Node
s1
s2
s
tree
lcs
mask
f
cur
Length
z
i
l
r
z
cur
ch
child
root
n
d1
l
r
i
len
n
d2
l
r
i
len
rnd
step
n
s
odd
Palindromes
even
Palindromes
odd
Palindromes
Slow
even
Palindromes
Slow
n
d1
i
len
n
d2
i
len
i
cur
State
cur
Dist
improved
rev
i
p
j
added
cost
delta
k
best
best
Pos
j
added
Edge
removed
Edge
cur
closing
Edge
n
t
res
i
j
dx
dy
res
i
j
res
improved
i
j
i1
j1
delta
w
h
i
j
i
i
population
Limit
population
n
i
mutation
Rate
generations
i
i1
i2
parent1
parent2
pair
n
i1
i2
n1
n2
used1
used2
i
i
pos1
pos2
i
n
i
j
n
t
res
i
j
dx
dy
res
i
j
res
improved
i
j
i1
j1
delta
w
h
i
j
i
m
n
index
i
a
L
i
j
j
E
t
j
i
j
j
i
d
i
a
b
c
x
res
res
i
res
i
i
cur
State
i
cur
Energy
best
Energy
temperature
cooling
Factor
i
j
i1
j1
delta
n
t
res
i
j
dx
dy
w
h
i
j
i
n
size
L
size
R
sums
L
sums
R
i
j
i
j
left
right
cur
a
h
cur
X
cur
Y
cur
F
step
best
F
best
X
best
Y
find
i
a
next
X
next
Y
next
F
p
g
is
Root
P
left
Child
X
p
g
last
y
rnd
step
n
p
nodes
i
query
cmd
u
x
v
y
lca
cur
path
v
y
root
mid
center
k
i
j
separator
dx
dy
t
d2
mid
dist2
R
r
d
step
qx
qy
n
x
y
min
Dist
i
metric
Tree
index
sub
sub
t
t
t1
t2
t1
t2
mx
sum
treap
i
j
k
res
i
j
k
t
i
ds
res
n
t
i
sqrtn
cnt
res
L
R
cur
a
queries
res
p
i
p
i
j
res
i
j
t
pos
removed
parent
child
t
rnd
step
n
q
h
op
v
x
q
mx
my
mx
my
res
t
n
list
i
i
t
p
g
is
Root
P
left
Child
X
p
g
last
y
rnd
step
n
g
val
nodes
i
query
cmd
u
v
x
y
path
res
path
delta
i
in
Left
lb
rb
lb
rb
lb
rb
mid
lo
hi
node
mid
p
i
pivot
b1
b2
cnt1
cnt2
i
a
t
t
p
g
is
Root
P
left
Child
X
p
g
last
y
rnd
step
n
g
nodes
i
query
cmd
u
v
x
y
i
n
size
max
Subtree
i
v
subtree
res
t
tree
hl
V
hl
E
res
t
i
j
res
lca
pos
block
Size
p
t
i
t1
t2
removed
Id
pos
pos
parent
child
t
tt
heap
res
res
t
res
m
y
i
i
m
y
m
y
m
y
res
m
y
m
y
res
sum
So
Far
t
tt
n
i
j
k
st
st
mid
k
i
j
separator
t
mid
dx
dy
dist
delta
delta2
step
qx
qy
n
x
y
min
Dist
i
kd
Tree
index
bucket
i
j
j
h
t
t
h
hv
res
treap
And
Result
treap
And
Result
t
n
mid
i
k
i
j
separator
t
mid
distance
delta
mid1
dist
mid1
dist
dx
dy
px
py
squared
Length
dot
Product
q
step
qx
qy
n
segments
min
Dist
i
x1
y1
x2
y2
r
Tree
index
s
mid
mid
mid
n
t1
t2
n
mid
i
k
i
j
separator
t
mid
ax
ay
bx
by
res
x
y
points
i
kd
Tree
count
centroid
n
n
tree
m
tree
sub
sub
t
t
t1
t2
t1
t2
mx
sum
m
res
single
sum
So
Far
treap
list
rnd
step
cmd
pos
value
pos
b
a
res
i
tr
b
a
delta
i
i
tr
v
mid
res
b
i
j
k
rnd
step
n
p
res1
res2
res
i
j
n
res
q
i
x
rnd
step
n
a
res1
res2
n
b
cur
next
i
i
j
R
C
res
d
d1
d2
st
r
c
size
c
c
j
rnd
step
R
C
a
r
c
res1
res2
res
R
C
r2
c2
r1
c1
r
c
n
p
i
j
n
rheights
i
lnsv
rnsv
res
i
a
b
cur
res
spos
sh
i
h
pos
rnd
step
n
h
res1
res2
dx
dy
moves
lo
hi
mid
lo
hi
mid
step
mid
rnd
step
n
b
first
True
res1
res2
res
p
next
t
n
jump
i
count
cur
tmp
next
rnd
step
n
middle
a
b1
b2
b3
n
used
order
i
reverse
Graph
i
comp
i
color
u
i
res
i
n
g
a
na
b
nb
c
nc
solution
lo
hi
mid
lo
hi
m1
m2
res
i
step
m1
m2
rnd
step
n
p
a
range
i
i
res
res2
tortoise
hare
start
Pos
length
power
length
tortoise
hare
start
Pos
i
rnd
step
a
b
c
f
floyd
brent
